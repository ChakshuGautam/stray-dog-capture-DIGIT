# ==============================================================================
# SDCRS (Stray Dog Capture & Reporting System) - Application Configuration
# ==============================================================================

# Server Configuration
server.port=8080
server.servlet.context-path=/sdcrs-services
server.tomcat.max-threads=10
server.compression.enabled=true

# Application Settings
spring.application.name=sdcrs-services
app.timezone=Asia/Kolkata

# ==============================================================================
# Database Configuration (via DIGIT Persister - no direct DB access)
# ==============================================================================
# Note: SDCRS uses DIGIT Persister for database writes via Kafka
# Direct database access is for reads only

spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.url=jdbc:postgresql://localhost:5432/egov
spring.datasource.username=postgres
spring.datasource.password=postgres

# ==============================================================================
# Kafka Configuration
# ==============================================================================

spring.kafka.bootstrap-servers=localhost:9092
spring.kafka.consumer.group-id=sdcrs-services
spring.kafka.consumer.auto-offset-reset=earliest
spring.kafka.consumer.key-deserializer=org.apache.kafka.common.serialization.StringDeserializer
spring.kafka.consumer.value-deserializer=org.springframework.kafka.support.serializer.JsonDeserializer
spring.kafka.consumer.properties.spring.json.trusted.packages=*
spring.kafka.producer.key-serializer=org.apache.kafka.common.serialization.StringSerializer
spring.kafka.producer.value-serializer=org.springframework.kafka.support.serializer.JsonSerializer

# SDCRS Kafka Topics
sdcrs.kafka.create.topic=save-sdcrs-report
sdcrs.kafka.update.topic=update-sdcrs-report
sdcrs.kafka.validation.topic=sdcrs-auto-validation
sdcrs.kafka.notification.topic=sdcrs-notification
sdcrs.kafka.payout-trigger.topic=sdcrs-payout-trigger
sdcrs.kafka.payout-update.topic=sdcrs-payout-update
sdcrs.kafka.payment-completed.topic=egov.collection.payment-completed

# ==============================================================================
# DIGIT Service Hosts
# ==============================================================================

egov.mdms.host=http://egov-mdms-service:8080
egov.mdms.search.endpoint=/egov-mdms-service/v1/_search

egov.idgen.host=http://egov-idgen:8080
egov.idgen.path=/egov-idgen/id/_generate

egov.workflow.host=http://egov-workflow-v2:8080
egov.workflow.transition.path=/egov-workflow-v2/egov-wf/process/_transition
egov.workflow.process.path=/egov-workflow-v2/egov-wf/process/_search

egov.user.host=http://egov-user:8080
egov.user.search.path=/user/_search

egov.localization.host=http://egov-localization:8080
egov.localization.search.path=/localization/messages/v1/_search

egov.filestore.host=http://egov-filestore:8080
egov.filestore.upload.path=/filestore/v1/files
egov.filestore.search.path=/filestore/v1/files/url

egov.notification.host=http://egov-notification-sms:8080
egov.notification.sms.path=/notification/sms/_send

egov.billing.host=http://billing-service:8080
egov.billing.demand.create.path=/billing-service/demand/_create
egov.billing.demand.search.path=/billing-service/demand/_search

egov.url.shortener.host=http://egov-url-shortening:8080
egov.url.shortener.path=/egov-url-shortening/shortener

# ==============================================================================
# IDGen Configuration
# ==============================================================================

sdcrs.idgen.report.name=sdcrs.reportnumber
sdcrs.idgen.report.format=DJ-SDCRS-[cy:yyyy]-[SEQ_SDCRS_REPORT]
sdcrs.idgen.tracking.name=sdcrs.trackingid
sdcrs.idgen.tracking.format=[CITY.CODE][SEQ_SDCRS_TRACKING]

# ==============================================================================
# Workflow Configuration
# ==============================================================================

sdcrs.workflow.business.service=SDCRS
sdcrs.workflow.module.name=sdcrs-services

# ==============================================================================
# Validation Settings
# ==============================================================================

# GPS validation - maximum allowed distance between submitted and EXIF GPS
sdcrs.validation.gps.tolerance.meters=100

# Image freshness - maximum age of photo in hours
sdcrs.validation.image.max.age.hours=48

# Duplicate detection - similarity threshold (0.0 to 1.0)
sdcrs.validation.duplicate.threshold=0.90

# Daily report limit per teacher
sdcrs.validation.daily.report.limit=5

# ==============================================================================
# Payout Configuration
# ==============================================================================

# Base payout amount per successful capture (in INR)
sdcrs.payout.amount=500

# Monthly payout cap per teacher (in INR)
sdcrs.payout.monthly.cap=5000

# Tax head code for billing service
sdcrs.payout.tax.head.code=SDCRS_PAYOUT

# Business service code for billing
sdcrs.payout.business.service=SDCRS-PAYOUT

# ==============================================================================
# Tracking Configuration
# ==============================================================================

# Base URL for public tracking page
sdcrs.tracking.url.base=https://sdcrs.djibouti.digit.org/track

# Enable URL shortening for tracking links
sdcrs.tracking.short.url.enabled=true

# ==============================================================================
# Search Configuration
# ==============================================================================

sdcrs.search.max.limit=100
sdcrs.search.default.limit=10
sdcrs.search.default.offset=0

# ==============================================================================
# MDMS Configuration
# ==============================================================================

sdcrs.mdms.module.name=SDCRS

# ==============================================================================
# Fraud Prevention Settings
# ==============================================================================

# Cooldown period after first warning (days)
sdcrs.fraud.cooldown.days=7

# Suspension period for repeated violations (days)
sdcrs.fraud.suspension.days=30

# Number of warnings before suspension
sdcrs.fraud.warning.threshold=3

# ==============================================================================
# Logging Configuration
# ==============================================================================

logging.level.root=INFO
logging.level.org.digit.sdcrs=DEBUG
logging.level.org.egov=INFO
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

# ==============================================================================
# Tracer Configuration (DIGIT Common)
# ==============================================================================

tracer.errors.provideExceptionInDetails=true

# ==============================================================================
# Management Endpoints
# ==============================================================================

management.endpoints.web.base-path=/
management.endpoints.web.exposure.include=health,info
