# DA-01: View Submission Volume Trends

[â† Back to User Stories Master](../../design-outputs/02-user-stories.md) | [â† Back to Admin Stories](./index.md)

## User Story

**As a** District Administrator,
**I want to** see submission volume trends (daily, weekly, monthly),
**So that** I can monitor program activity in my district.

## Description

District Administrators need visibility into how the stray dog reporting program is performing over time. This dashboard provides trend analysis of submissions, helping administrators understand activity patterns, seasonal variations, and program growth.

## Acceptance Criteria

### Functional Requirements
- [ ] Dashboard displays submissions count by day, week, and month
- [ ] Line charts show trend over selected time period
- [ ] Can toggle between daily, weekly, monthly aggregation
- [ ] Can filter by: date range, block, status
- [ ] Can compare current period vs previous period
- [ ] Shows growth percentage (positive/negative indicator)
- [ ] Breakdown by submission status (verified, rejected, pending)

### Non-Functional Requirements
- [ ] Dashboard loads within 3 seconds
- [ ] Data refreshes automatically every 5 minutes
- [ ] Charts are responsive on tablet/desktop
- [ ] Supports data export for reporting

## UI/UX Design

### Submission Trends Dashboard
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ› District Admin Dashboard                    ðŸ””  ðŸ‘¤ Admin   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ District: Patna                                                 â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  ðŸ“Š Submission Volume                                       â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚  Time Range: [ Last 30 Days â–¼ ]    View: [ Daily â–¼ ]       â”‚ â”‚
â”‚ â”‚  Compare to: [ Previous Period âœ“ ]                         â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚  Total       â”‚  Verified    â”‚  Rejected    â”‚  Pending     â”‚  â”‚
â”‚ â”‚  ðŸ“„ 1,245    â”‚  âœ“ 987       â”‚  âœ— 201       â”‚  â³ 57       â”‚  â”‚
â”‚ â”‚  â†‘ 12%       â”‚  â†‘ 15%       â”‚  â†“ 5%        â”‚  â†“ 22%       â”‚  â”‚
â”‚ â”‚  vs prev     â”‚  vs prev     â”‚  vs prev     â”‚  vs prev     â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                    SUBMISSION TRENDS                        â”‚ â”‚
â”‚ â”‚  100â”‚          ____                                         â”‚ â”‚
â”‚ â”‚     â”‚        /      \     ____                              â”‚ â”‚
â”‚ â”‚   75â”‚       /        \   /    \                             â”‚ â”‚
â”‚ â”‚     â”‚    __/          \_/      \__                          â”‚ â”‚
â”‚ â”‚   50â”‚   /                          \                        â”‚ â”‚
â”‚ â”‚     â”‚  /                            \___                    â”‚ â”‚
â”‚ â”‚   25â”‚_/                                  \___               â”‚ â”‚
â”‚ â”‚     â”‚                                                       â”‚ â”‚
â”‚ â”‚    0â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€             â”‚ â”‚
â”‚ â”‚         Nov 7  Nov 14 Nov 21 Nov 28 Dec 5  Today            â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚  â”€â”€â”€ Total   â”€â”€â”€ Verified   --- Rejected                   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  ðŸ“… Daily Breakdown (Last 7 Days)                          â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚ â”‚
â”‚ â”‚ Date       â”‚ Total â”‚ Verified â”‚ Rejected â”‚ Pending â”‚       â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚ â”‚
â”‚ â”‚ Dec 7      â”‚   45  â”‚    38    â”‚    5     â”‚    2    â”‚       â”‚ â”‚
â”‚ â”‚ Dec 6      â”‚   52  â”‚    42    â”‚    8     â”‚    2    â”‚       â”‚ â”‚
â”‚ â”‚ Dec 5      â”‚   48  â”‚    41    â”‚    6     â”‚    1    â”‚       â”‚ â”‚
â”‚ â”‚ Dec 4      â”‚   39  â”‚    31    â”‚    7     â”‚    1    â”‚       â”‚ â”‚
â”‚ â”‚ Dec 3      â”‚   55  â”‚    48    â”‚    5     â”‚    2    â”‚       â”‚ â”‚
â”‚ â”‚ Dec 2      â”‚   61  â”‚    52    â”‚    7     â”‚    2    â”‚       â”‚ â”‚
â”‚ â”‚ Dec 1      â”‚   43  â”‚    36    â”‚    6     â”‚    1    â”‚       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ â”‚
â”‚                                                   [Export CSV] â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  ðŸ—º Block-wise Distribution                                 â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚ â”‚
â”‚ â”‚ Block          â”‚ Count â”‚ % Total  â”‚ Trend           â”‚      â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚ â”‚
â”‚ â”‚ Patna City     â”‚  423  â”‚   34%    â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ â†‘18% â”‚      â”‚ â”‚
â”‚ â”‚ Danapur        â”‚  298  â”‚   24%    â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘ â†‘5%  â”‚      â”‚ â”‚
â”‚ â”‚ Phulwari       â”‚  187  â”‚   15%    â”‚ â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘ â†“2%  â”‚      â”‚ â”‚
â”‚ â”‚ Sampatchak     â”‚  156  â”‚   13%    â”‚ â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â†‘8%  â”‚      â”‚ â”‚
â”‚ â”‚ Other          â”‚  181  â”‚   14%    â”‚ â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘ â†‘3%  â”‚      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Technical Implementation

### Dashboard Service
```javascript
// src/services/admin/SubmissionTrendsService.js

class SubmissionTrendsService {
  static TIME_RANGES = {
    LAST_7_DAYS: { days: 7, label: 'Last 7 Days' },
    LAST_30_DAYS: { days: 30, label: 'Last 30 Days' },
    LAST_90_DAYS: { days: 90, label: 'Last 90 Days' },
    THIS_MONTH: { label: 'This Month' },
    THIS_QUARTER: { label: 'This Quarter' },
    CUSTOM: { label: 'Custom Range' }
  };

  static AGGREGATIONS = {
    DAILY: 'day',
    WEEKLY: 'week',
    MONTHLY: 'month'
  };

  // Fetch submission trends for district
  static async getTrends(districtId, options = {}) {
    const {
      startDate,
      endDate,
      aggregation = 'day',
      blockId = null,
      comparePrevious = true
    } = options;

    const params = new URLSearchParams({
      districtId,
      startDate: startDate.toISOString(),
      endDate: endDate.toISOString(),
      aggregation,
      comparePrevious: comparePrevious.toString()
    });

    if (blockId) {
      params.append('blockId', blockId);
    }

    const response = await fetch(`/api/admin/submissions/trends?${params}`);
    if (!response.ok) {
      throw new Error('Failed to fetch submission trends');
    }

    return response.json();
  }

  // Get summary statistics
  static async getSummaryStats(districtId, timeRange) {
    const response = await fetch(
      `/api/admin/submissions/summary?districtId=${districtId}&timeRange=${timeRange}`
    );
    return response.json();
  }

  // Get block-wise breakdown
  static async getBlockBreakdown(districtId, timeRange) {
    const response = await fetch(
      `/api/admin/submissions/by-block?districtId=${districtId}&timeRange=${timeRange}`
    );
    return response.json();
  }

  // Calculate growth percentage
  static calculateGrowth(current, previous) {
    if (previous === 0) return current > 0 ? 100 : 0;
    return Math.round(((current - previous) / previous) * 100);
  }

  // Format trend data for chart
  static formatChartData(trendData, aggregation) {
    return trendData.map(item => ({
      date: this.formatDateLabel(item.date, aggregation),
      total: item.total,
      verified: item.verified,
      rejected: item.rejected,
      pending: item.pending
    }));
  }

  static formatDateLabel(date, aggregation) {
    const d = new Date(date);
    switch (aggregation) {
      case 'day':
        return d.toLocaleDateString('en-IN', { month: 'short', day: 'numeric' });
      case 'week':
        return `Week ${this.getWeekNumber(d)}`;
      case 'month':
        return d.toLocaleDateString('en-IN', { month: 'short', year: 'numeric' });
      default:
        return d.toLocaleDateString();
    }
  }

  static getWeekNumber(date) {
    const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));
    d.setUTCDate(d.getUTCDate() + 4 - (d.getUTCDay() || 7));
    const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));
    return Math.ceil((((d - yearStart) / 86400000) + 1) / 7);
  }
}

export default SubmissionTrendsService;
```

### Trends Dashboard Component
```jsx
// src/components/admin/SubmissionTrendsDashboard.jsx
import React, { useState, useEffect, useMemo } from 'react';
import { Line } from 'react-chartjs-2';
import SubmissionTrendsService from '../../services/admin/SubmissionTrendsService';

function SubmissionTrendsDashboard({ districtId }) {
  const [timeRange, setTimeRange] = useState('LAST_30_DAYS');
  const [aggregation, setAggregation] = useState('day');
  const [comparePrevious, setComparePrevious] = useState(true);
  const [selectedBlock, setSelectedBlock] = useState(null);

  const [trendData, setTrendData] = useState([]);
  const [summaryStats, setSummaryStats] = useState(null);
  const [blockData, setBlockData] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    fetchDashboardData();
  }, [districtId, timeRange, aggregation, selectedBlock, comparePrevious]);

  const fetchDashboardData = async () => {
    setLoading(true);
    try {
      const { startDate, endDate } = getDateRange(timeRange);

      const [trends, summary, blocks] = await Promise.all([
        SubmissionTrendsService.getTrends(districtId, {
          startDate,
          endDate,
          aggregation,
          blockId: selectedBlock,
          comparePrevious
        }),
        SubmissionTrendsService.getSummaryStats(districtId, timeRange),
        SubmissionTrendsService.getBlockBreakdown(districtId, timeRange)
      ]);

      setTrendData(trends.data);
      setSummaryStats(summary);
      setBlockData(blocks);
    } catch (error) {
      console.error('Failed to fetch dashboard data:', error);
    } finally {
      setLoading(false);
    }
  };

  const getDateRange = (range) => {
    const endDate = new Date();
    let startDate = new Date();

    switch (range) {
      case 'LAST_7_DAYS':
        startDate.setDate(endDate.getDate() - 7);
        break;
      case 'LAST_30_DAYS':
        startDate.setDate(endDate.getDate() - 30);
        break;
      case 'LAST_90_DAYS':
        startDate.setDate(endDate.getDate() - 90);
        break;
      case 'THIS_MONTH':
        startDate = new Date(endDate.getFullYear(), endDate.getMonth(), 1);
        break;
      default:
        startDate.setDate(endDate.getDate() - 30);
    }

    return { startDate, endDate };
  };

  const chartData = useMemo(() => {
    const formatted = SubmissionTrendsService.formatChartData(trendData, aggregation);
    return {
      labels: formatted.map(d => d.date),
      datasets: [
        {
          label: 'Total',
          data: formatted.map(d => d.total),
          borderColor: '#2196f3',
          tension: 0.4,
          fill: false
        },
        {
          label: 'Verified',
          data: formatted.map(d => d.verified),
          borderColor: '#4caf50',
          tension: 0.4,
          fill: false
        },
        {
          label: 'Rejected',
          data: formatted.map(d => d.rejected),
          borderColor: '#f44336',
          borderDash: [5, 5],
          tension: 0.4,
          fill: false
        }
      ]
    };
  }, [trendData, aggregation]);

  const chartOptions = {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: {
        position: 'bottom'
      },
      tooltip: {
        mode: 'index',
        intersect: false
      }
    },
    scales: {
      y: {
        beginAtZero: true,
        ticks: { precision: 0 }
      }
    }
  };

  const exportToCSV = () => {
    const headers = ['Date', 'Total', 'Verified', 'Rejected', 'Pending'];
    const rows = trendData.map(row => [
      row.date,
      row.total,
      row.verified,
      row.rejected,
      row.pending
    ]);

    const csv = [headers, ...rows].map(r => r.join(',')).join('\n');
    const blob = new Blob([csv], { type: 'text/csv' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `submission-trends-${timeRange}.csv`;
    a.click();
  };

  if (loading) {
    return <div className="loading-spinner">Loading dashboard...</div>;
  }

  return (
    <div className="trends-dashboard">
      <div className="dashboard-header">
        <h2>ðŸ“Š Submission Volume</h2>
        <div className="filters">
          <select
            value={timeRange}
            onChange={(e) => setTimeRange(e.target.value)}
          >
            {Object.entries(SubmissionTrendsService.TIME_RANGES).map(([key, val]) => (
              <option key={key} value={key}>{val.label}</option>
            ))}
          </select>

          <select
            value={aggregation}
            onChange={(e) => setAggregation(e.target.value)}
          >
            <option value="day">Daily</option>
            <option value="week">Weekly</option>
            <option value="month">Monthly</option>
          </select>

          <label className="checkbox-filter">
            <input
              type="checkbox"
              checked={comparePrevious}
              onChange={(e) => setComparePrevious(e.target.checked)}
            />
            Compare to previous period
          </label>
        </div>
      </div>

      {/* Summary Cards */}
      {summaryStats && (
        <div className="summary-cards">
          <SummaryCard
            icon="ðŸ“„"
            label="Total"
            value={summaryStats.total}
            change={summaryStats.totalChange}
          />
          <SummaryCard
            icon="âœ“"
            label="Verified"
            value={summaryStats.verified}
            change={summaryStats.verifiedChange}
          />
          <SummaryCard
            icon="âœ—"
            label="Rejected"
            value={summaryStats.rejected}
            change={summaryStats.rejectedChange}
          />
          <SummaryCard
            icon="â³"
            label="Pending"
            value={summaryStats.pending}
            change={summaryStats.pendingChange}
          />
        </div>
      )}

      {/* Trend Chart */}
      <div className="chart-container">
        <h3>Submission Trends</h3>
        <div className="chart-wrapper" style={{ height: '300px' }}>
          <Line data={chartData} options={chartOptions} />
        </div>
      </div>

      {/* Block Breakdown */}
      <div className="block-breakdown">
        <div className="section-header">
          <h3>ðŸ—º Block-wise Distribution</h3>
          <button onClick={exportToCSV} className="export-btn">
            Export CSV
          </button>
        </div>
        <table className="data-table">
          <thead>
            <tr>
              <th>Block</th>
              <th>Count</th>
              <th>% Total</th>
              <th>Trend</th>
            </tr>
          </thead>
          <tbody>
            {blockData.map(block => (
              <tr key={block.id}>
                <td>{block.name}</td>
                <td>{block.count}</td>
                <td>{block.percentage}%</td>
                <td>
                  <TrendBar value={block.percentage} change={block.change} />
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    </div>
  );
}

function SummaryCard({ icon, label, value, change }) {
  const isPositive = change >= 0;
  return (
    <div className="summary-card">
      <div className="card-icon">{icon}</div>
      <div className="card-value">{value.toLocaleString()}</div>
      <div className="card-label">{label}</div>
      <div className={`card-change ${isPositive ? 'positive' : 'negative'}`}>
        {isPositive ? 'â†‘' : 'â†“'} {Math.abs(change)}% vs prev
      </div>
    </div>
  );
}

function TrendBar({ value, change }) {
  const barWidth = Math.min(value, 100);
  const isPositive = change >= 0;
  return (
    <div className="trend-bar-container">
      <div className="trend-bar" style={{ width: `${barWidth}%` }} />
      <span className={`trend-change ${isPositive ? 'positive' : 'negative'}`}>
        {isPositive ? 'â†‘' : 'â†“'}{Math.abs(change)}%
      </span>
    </div>
  );
}

export default SubmissionTrendsDashboard;
```

### Backend API
```javascript
// Backend: routes/admin/submissions.js
const express = require('express');
const router = express.Router();

// Get submission trends
router.get('/trends', async (req, res) => {
  try {
    const {
      districtId,
      startDate,
      endDate,
      aggregation,
      blockId,
      comparePrevious
    } = req.query;

    // Build aggregation query
    const pipeline = [
      {
        $match: {
          districtId,
          createdAt: {
            $gte: new Date(startDate),
            $lte: new Date(endDate)
          },
          ...(blockId && { blockId })
        }
      },
      {
        $group: {
          _id: {
            $dateTrunc: { date: '$createdAt', unit: aggregation }
          },
          total: { $sum: 1 },
          verified: {
            $sum: { $cond: [{ $eq: ['$status', 'VERIFIED'] }, 1, 0] }
          },
          rejected: {
            $sum: { $cond: [{ $eq: ['$status', 'REJECTED'] }, 1, 0] }
          },
          pending: {
            $sum: { $cond: [{ $eq: ['$status', 'PENDING'] }, 1, 0] }
          }
        }
      },
      { $sort: { _id: 1 } }
    ];

    const data = await Incident.aggregate(pipeline);

    // Transform data
    const formatted = data.map(item => ({
      date: item._id,
      total: item.total,
      verified: item.verified,
      rejected: item.rejected,
      pending: item.pending
    }));

    res.json({ data: formatted });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

// Get summary statistics
router.get('/summary', async (req, res) => {
  try {
    const { districtId, timeRange } = req.query;
    const { startDate, endDate, prevStartDate, prevEndDate } = getDateRanges(timeRange);

    const [current, previous] = await Promise.all([
      getStats(districtId, startDate, endDate),
      getStats(districtId, prevStartDate, prevEndDate)
    ]);

    res.json({
      total: current.total,
      totalChange: calcChange(current.total, previous.total),
      verified: current.verified,
      verifiedChange: calcChange(current.verified, previous.verified),
      rejected: current.rejected,
      rejectedChange: calcChange(current.rejected, previous.rejected),
      pending: current.pending,
      pendingChange: calcChange(current.pending, previous.pending)
    });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

module.exports = router;
```

## Dependencies

- **Chart.js / react-chartjs-2**: Line charts for trends
- **egov-location**: District and block data
- **Incident API**: Submission data aggregation

## Related Stories

- [DA-02](./DA-02.md) - Verification Funnel
- [DA-03](./DA-03.md) - Teacher Participation Rate
- [SA-01](../state-admin/SA-01.md) - Statewide Metrics

## Notes

- Data refreshes automatically every 5 minutes
- Charts support drill-down into specific blocks
- Export feature helps share data in offline meetings
- Compare feature essential for understanding growth
