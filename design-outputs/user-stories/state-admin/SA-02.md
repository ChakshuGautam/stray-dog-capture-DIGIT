# SA-02: Compare Districts

[â† Back to User Stories Master](../../design-outputs/02-user-stories.md) | [â† Back to Admin Stories](./index.md)

## User Story

**As a** State Administrator,
**I want to** compare districts by participation rate, fraud rate, and payout,
**So that** I can identify best practices and areas needing intervention.

## Description

District comparison enables state administrators to benchmark performance across districts, identify outliers (both positive and negative), and allocate resources effectively. This supports data-driven policy decisions and targeted interventions.

## Acceptance Criteria

### Functional Requirements
- [ ] Side-by-side comparison of up to 5 districts
- [ ] Comparison metrics: participation rate, verification rate, fraud rate, capture rate, payout amounts
- [ ] Ranking view showing all districts by selected metric
- [ ] Trend comparison over time
- [ ] Normalized metrics (per teacher, per capita)
- [ ] Highlight outliers (top/bottom performers)
- [ ] Export comparison reports

### Non-Functional Requirements
- [ ] Comparison loads within 3 seconds
- [ ] Support for all 38 Bihar districts
- [ ] Data consistency across comparison views

## UI/UX Design

### District Comparison Dashboard
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ“Š District Comparison                                     December 2024    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Select Districts to Compare (max 5):                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Patna     âœ“ â”‚ â”‚ Gaya      âœ“ â”‚ â”‚ Muzaffar- âœ“ â”‚ â”‚ Bhagalpur âœ“ â”‚ â”‚ + Add  â”‚â”‚
â”‚  â”‚             â”‚ â”‚             â”‚ â”‚ pur         â”‚ â”‚             â”‚ â”‚        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  ðŸ“ˆ Performance Comparison                                              â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚                                                                         â”‚â”‚
â”‚  â”‚  Metric: [Participation Rate â–¼]                                         â”‚â”‚
â”‚  â”‚                                                                         â”‚â”‚
â”‚  â”‚  60% â”‚                                                                  â”‚â”‚
â”‚  â”‚      â”‚  â–ˆâ–ˆâ–ˆâ–ˆ                                                            â”‚â”‚
â”‚  â”‚  50% â”‚  â–ˆâ–ˆâ–ˆâ–ˆ                                                            â”‚â”‚
â”‚  â”‚      â”‚  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ                                                      â”‚â”‚
â”‚  â”‚  40% â”‚  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ                                                â”‚â”‚
â”‚  â”‚      â”‚  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ                                          â”‚â”‚
â”‚  â”‚  30% â”‚  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ                                          â”‚â”‚
â”‚  â”‚      â”‚  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ                                          â”‚â”‚
â”‚  â”‚  20% â”‚  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ                                          â”‚â”‚
â”‚  â”‚      â”‚  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ                                          â”‚â”‚
â”‚  â”‚  10% â”‚  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ                                          â”‚â”‚
â”‚  â”‚      â”‚  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ                                          â”‚â”‚
â”‚  â”‚   0% â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€                                       â”‚â”‚
â”‚  â”‚       Patna  Gaya  Muzaffar Bhagalpur                                   â”‚â”‚
â”‚  â”‚        52%   45%    38%      35%                                        â”‚â”‚
â”‚  â”‚                              State Avg: 42% â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â”‚â”‚
â”‚  â”‚                                                                         â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  ðŸ“‹ Detailed Metrics Comparison                                        â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ Metric       â”‚ Patna    â”‚ Gaya     â”‚ Muzaffarpurâ”‚ Bhagalpur  â”‚ State   â”‚â”‚
â”‚  â”‚              â”‚          â”‚          â”‚            â”‚            â”‚ Avg     â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ Teachers     â”‚  2,340   â”‚  1,890   â”‚   1,456    â”‚   1,234    â”‚  1,128  â”‚â”‚
â”‚  â”‚ Active       â”‚  1,217   â”‚   850    â”‚    553     â”‚    432     â”‚   474   â”‚â”‚
â”‚  â”‚ Participationâ”‚   52% â¬†  â”‚   45%    â”‚    38%     â”‚    35% â¬‡   â”‚   42%   â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ Submissions  â”‚  8,234   â”‚  6,890   â”‚   5,234    â”‚   4,567    â”‚  4,256  â”‚â”‚
â”‚  â”‚ Verified     â”‚  7,123   â”‚  5,678   â”‚   4,345    â”‚   3,890    â”‚  3,567  â”‚â”‚
â”‚  â”‚ Ver. Rate    â”‚   87% â¬†  â”‚   82%    â”‚    83%     â”‚    85%     â”‚   84%   â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ Captured     â”‚  5,890   â”‚  4,567   â”‚   3,456    â”‚   3,123    â”‚  2,890  â”‚â”‚
â”‚  â”‚ Capture Rate â”‚   83%    â”‚   80%    â”‚    80%     â”‚    80%     â”‚   81%   â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ Fraud Cases  â”‚    23    â”‚    18    â”‚     31     â”‚     12     â”‚    15   â”‚â”‚
â”‚  â”‚ Fraud Rate   â”‚  0.28%   â”‚  0.26%   â”‚   0.59% âš   â”‚   0.26%    â”‚  0.35%  â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ Total Payout â”‚ â‚¹29.45L  â”‚ â‚¹22.84L  â”‚  â‚¹17.28L   â”‚  â‚¹15.62L   â”‚ â‚¹14.45L â”‚â”‚
â”‚  â”‚ Per Capture  â”‚  â‚¹500    â”‚  â‚¹500    â”‚   â‚¹500     â”‚   â‚¹500     â”‚  â‚¹500   â”‚â”‚
â”‚  â”‚ Avg/Teacher  â”‚ â‚¹2,419   â”‚ â‚¹2,687   â”‚  â‚¹3,125 âš   â”‚  â‚¹3,616 âš   â”‚ â‚¹3,048  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                             â”‚
â”‚  Legend: â¬† Best performer  â¬‡ Lowest  âš  Outlier (>1.5Ã— std dev)            â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  ðŸ“ˆ Trend Comparison (Last 6 Months)                                    â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚                                                                         â”‚â”‚
â”‚  â”‚  Participation Rate Trend:                                              â”‚â”‚
â”‚  â”‚                                                                         â”‚â”‚
â”‚  â”‚  55% â”‚            â•­â”€â”€â”€â”€â”€ Patna                                          â”‚â”‚
â”‚  â”‚      â”‚       â•­â”€â”€â”€â”€â•¯                                                     â”‚â”‚
â”‚  â”‚  50% â”‚  â•­â”€â”€â”€â”€â•¯         â•­â”€â”€â”€â”€â”€ Gaya                                      â”‚â”‚
â”‚  â”‚      â”‚  â”‚         â•­â”€â”€â”€â”€â•¯                                                â”‚â”‚
â”‚  â”‚  45% â”‚  â”‚    â•­â”€â”€â”€â”€â•¯                                                     â”‚â”‚
â”‚  â”‚      â”‚  â”‚    â”‚    â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Muzaffarpur                               â”‚â”‚
â”‚  â”‚  40% â”‚â”€â”€â”€â”€â”€â”€â•¯â”€â”€â”€â”€â•¯                                                      â”‚â”‚
â”‚  â”‚      â”‚  â”‚         â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Bhagalpur                                 â”‚â”‚
â”‚  â”‚  35% â”‚â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯                                                     â”‚â”‚
â”‚  â”‚      â””â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€                            â”‚â”‚
â”‚  â”‚         Jul   Aug   Sep   Oct   Nov   Dec                               â”‚â”‚
â”‚  â”‚                                                                         â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  ðŸ† State Rankings (All 38 Districts)                 [By: Part. Rate]  â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚                                                                         â”‚â”‚
â”‚  â”‚  Rank  District           Part.Rate  Ver.Rate  Fraud    Trend          â”‚â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚â”‚
â”‚  â”‚  1.    Patna              52%        87%       0.28%    â†‘5%            â”‚â”‚
â”‚  â”‚  2.    Samastipur         49%        85%       0.32%    â†‘3%            â”‚â”‚
â”‚  â”‚  3.    Nalanda            48%        84%       0.25%    â†‘4%            â”‚â”‚
â”‚  â”‚  4.    Gaya               45%        82%       0.26%    â†‘2%            â”‚â”‚
â”‚  â”‚  ...                                                                    â”‚â”‚
â”‚  â”‚  35.   Kishanganj         28%        78%       0.45%    â†“1%            â”‚â”‚
â”‚  â”‚  36.   Araria             26%        76%       0.52%    â†“2%            â”‚â”‚
â”‚  â”‚  37.   Katihar            24%        75%       0.48%    â†“3%            â”‚â”‚
â”‚  â”‚  38.   Purnia             22%        74%       0.55%    â†“4%            â”‚â”‚
â”‚  â”‚                                                                         â”‚â”‚
â”‚  â”‚                                              [View Full Rankings]       â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                             â”‚
â”‚                     [Export Comparison] [Save as Template] [Share Report]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Technical Implementation

### District Comparison Service
```javascript
// src/services/stateAdmin/DistrictComparisonService.js

class DistrictComparisonService {
  static COMPARISON_METRICS = {
    PARTICIPATION_RATE: 'participationRate',
    VERIFICATION_RATE: 'verificationRate',
    CAPTURE_RATE: 'captureRate',
    FRAUD_RATE: 'fraudRate',
    TOTAL_PAYOUT: 'totalPayout',
    AVG_PAYOUT_PER_TEACHER: 'avgPayoutPerTeacher',
    SUBMISSIONS: 'submissions'
  };

  static MAX_COMPARISON_DISTRICTS = 5;

  static async getDistrictList() {
    const response = await fetch('/api/state-admin/districts', {
      headers: { 'Authorization': `Bearer ${getAuthToken()}` }
    });
    return response.json();
  }

  static async compareDistricts(districtIds, startDate, endDate) {
    const params = new URLSearchParams({
      districtIds: districtIds.join(','),
      startDate: startDate.toISOString(),
      endDate: endDate.toISOString()
    });

    const response = await fetch(`/api/state-admin/compare?${params}`, {
      headers: { 'Authorization': `Bearer ${getAuthToken()}` }
    });
    return response.json();
  }

  static async getDistrictRankings(metric, limit = 38) {
    const params = new URLSearchParams({ metric, limit: limit.toString() });
    const response = await fetch(`/api/state-admin/rankings?${params}`, {
      headers: { 'Authorization': `Bearer ${getAuthToken()}` }
    });
    return response.json();
  }

  static async getTrendComparison(districtIds, months = 6) {
    const params = new URLSearchParams({
      districtIds: districtIds.join(','),
      months: months.toString()
    });

    const response = await fetch(`/api/state-admin/compare/trends?${params}`, {
      headers: { 'Authorization': `Bearer ${getAuthToken()}` }
    });
    return response.json();
  }

  static async getStateAverages(startDate, endDate) {
    const params = new URLSearchParams({
      startDate: startDate.toISOString(),
      endDate: endDate.toISOString()
    });

    const response = await fetch(`/api/state-admin/state-averages?${params}`, {
      headers: { 'Authorization': `Bearer ${getAuthToken()}` }
    });
    return response.json();
  }

  static calculateStandardDeviation(values) {
    const n = values.length;
    if (n === 0) return 0;

    const mean = values.reduce((a, b) => a + b, 0) / n;
    const squareDiffs = values.map(value => Math.pow(value - mean, 2));
    const avgSquareDiff = squareDiffs.reduce((a, b) => a + b, 0) / n;

    return Math.sqrt(avgSquareDiff);
  }

  static identifyOutliers(districts, metric, threshold = 1.5) {
    const values = districts.map(d => d[metric]);
    const mean = values.reduce((a, b) => a + b, 0) / values.length;
    const stdDev = this.calculateStandardDeviation(values);

    return districts.map(d => ({
      ...d,
      isOutlier: Math.abs(d[metric] - mean) > threshold * stdDev,
      outlierDirection: d[metric] > mean ? 'high' : 'low'
    }));
  }

  static getBestPerformer(districts, metric, lowerIsBetter = false) {
    return districts.reduce((best, current) => {
      if (lowerIsBetter) {
        return current[metric] < best[metric] ? current : best;
      }
      return current[metric] > best[metric] ? current : best;
    });
  }

  static getWorstPerformer(districts, metric, lowerIsBetter = false) {
    return districts.reduce((worst, current) => {
      if (lowerIsBetter) {
        return current[metric] > worst[metric] ? current : worst;
      }
      return current[metric] < worst[metric] ? current : worst;
    });
  }
}

export default DistrictComparisonService;
```

### District Comparison Component
```jsx
// src/components/stateAdmin/DistrictComparison.jsx
import React, { useState, useEffect, useMemo } from 'react';
import { Bar, Line } from 'react-chartjs-2';
import DistrictComparisonService from '../../services/stateAdmin/DistrictComparisonService';

function DistrictComparison() {
  const [allDistricts, setAllDistricts] = useState([]);
  const [selectedDistricts, setSelectedDistricts] = useState([]);
  const [comparisonData, setComparisonData] = useState(null);
  const [stateAverages, setStateAverages] = useState(null);
  const [trendData, setTrendData] = useState(null);
  const [rankings, setRankings] = useState([]);
  const [selectedMetric, setSelectedMetric] = useState('participationRate');
  const [rankingMetric, setRankingMetric] = useState('participationRate');
  const [dateRange, setDateRange] = useState({
    start: getLastMonthStart(),
    end: new Date()
  });
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    loadDistricts();
  }, []);

  useEffect(() => {
    if (selectedDistricts.length > 0) {
      loadComparisonData();
    }
  }, [selectedDistricts, dateRange]);

  useEffect(() => {
    loadRankings();
  }, [rankingMetric]);

  const loadDistricts = async () => {
    const districts = await DistrictComparisonService.getDistrictList();
    setAllDistricts(districts);
    // Pre-select first 4 districts
    setSelectedDistricts(districts.slice(0, 4).map(d => d.id));
    setLoading(false);
  };

  const loadComparisonData = async () => {
    setLoading(true);
    try {
      const [comparison, averages, trends] = await Promise.all([
        DistrictComparisonService.compareDistricts(selectedDistricts, dateRange.start, dateRange.end),
        DistrictComparisonService.getStateAverages(dateRange.start, dateRange.end),
        DistrictComparisonService.getTrendComparison(selectedDistricts, 6)
      ]);

      // Identify outliers
      const withOutliers = DistrictComparisonService.identifyOutliers(
        comparison,
        selectedMetric
      );

      setComparisonData(withOutliers);
      setStateAverages(averages);
      setTrendData(trends);
    } catch (error) {
      console.error('Failed to load comparison data:', error);
    } finally {
      setLoading(false);
    }
  };

  const loadRankings = async () => {
    const data = await DistrictComparisonService.getDistrictRankings(rankingMetric);
    setRankings(data);
  };

  const addDistrict = (districtId) => {
    if (selectedDistricts.length < DistrictComparisonService.MAX_COMPARISON_DISTRICTS) {
      setSelectedDistricts([...selectedDistricts, districtId]);
    }
  };

  const removeDistrict = (districtId) => {
    setSelectedDistricts(selectedDistricts.filter(id => id !== districtId));
  };

  const barChartData = useMemo(() => {
    if (!comparisonData) return null;

    return {
      labels: comparisonData.map(d => d.name),
      datasets: [{
        label: getMetricLabel(selectedMetric),
        data: comparisonData.map(d => d[selectedMetric]),
        backgroundColor: comparisonData.map(d =>
          d.isOutlier ? (d.outlierDirection === 'high' ? '#4caf50' : '#f44336') : '#2196f3'
        ),
        borderWidth: 1
      }]
    };
  }, [comparisonData, selectedMetric]);

  const trendChartData = useMemo(() => {
    if (!trendData) return null;

    return {
      labels: trendData.labels,
      datasets: trendData.series.map((series, index) => ({
        label: series.name,
        data: series.values,
        borderColor: getDistrictColor(index),
        fill: false,
        tension: 0.4
      }))
    };
  }, [trendData]);

  const bestPerformer = useMemo(() => {
    if (!comparisonData) return null;
    return DistrictComparisonService.getBestPerformer(
      comparisonData,
      selectedMetric,
      selectedMetric === 'fraudRate'
    );
  }, [comparisonData, selectedMetric]);

  const worstPerformer = useMemo(() => {
    if (!comparisonData) return null;
    return DistrictComparisonService.getWorstPerformer(
      comparisonData,
      selectedMetric,
      selectedMetric === 'fraudRate'
    );
  }, [comparisonData, selectedMetric]);

  if (loading && !comparisonData) {
    return <div className="loading-spinner">Loading comparison data...</div>;
  }

  return (
    <div className="district-comparison">
      <h1>District Comparison</h1>

      {/* District Selection */}
      <div className="district-selector">
        <p>Select Districts to Compare (max {DistrictComparisonService.MAX_COMPARISON_DISTRICTS}):</p>
        <div className="selected-districts">
          {selectedDistricts.map(id => {
            const district = allDistricts.find(d => d.id === id);
            return (
              <div key={id} className="selected-district-chip">
                {district?.name}
                <button onClick={() => removeDistrict(id)}>Ã—</button>
              </div>
            );
          })}
          {selectedDistricts.length < DistrictComparisonService.MAX_COMPARISON_DISTRICTS && (
            <select
              onChange={(e) => addDistrict(e.target.value)}
              value=""
            >
              <option value="">+ Add District</option>
              {allDistricts
                .filter(d => !selectedDistricts.includes(d.id))
                .map(d => (
                  <option key={d.id} value={d.id}>{d.name}</option>
                ))}
            </select>
          )}
        </div>
      </div>

      {/* Performance Comparison Chart */}
      {barChartData && (
        <div className="comparison-chart-section">
          <div className="chart-header">
            <h2>Performance Comparison</h2>
            <select
              value={selectedMetric}
              onChange={(e) => setSelectedMetric(e.target.value)}
            >
              {Object.entries(DistrictComparisonService.COMPARISON_METRICS).map(([key, value]) => (
                <option key={key} value={value}>{getMetricLabel(value)}</option>
              ))}
            </select>
          </div>
          <Bar
            data={barChartData}
            options={{
              responsive: true,
              plugins: {
                annotation: {
                  annotations: {
                    stateLine: {
                      type: 'line',
                      yMin: stateAverages?.[selectedMetric],
                      yMax: stateAverages?.[selectedMetric],
                      borderColor: '#666',
                      borderDash: [5, 5],
                      label: {
                        content: `State Avg: ${stateAverages?.[selectedMetric]}%`,
                        enabled: true
                      }
                    }
                  }
                }
              }
            }}
          />
        </div>
      )}

      {/* Detailed Metrics Table */}
      {comparisonData && (
        <div className="metrics-table-section">
          <h2>Detailed Metrics Comparison</h2>
          <table className="comparison-table">
            <thead>
              <tr>
                <th>Metric</th>
                {comparisonData.map(d => (
                  <th key={d.id}>{d.name}</th>
                ))}
                <th>State Avg</th>
              </tr>
            </thead>
            <tbody>
              <MetricRow
                label="Teachers"
                data={comparisonData}
                metric="totalTeachers"
                stateAvg={stateAverages?.totalTeachers}
              />
              <MetricRow
                label="Active"
                data={comparisonData}
                metric="activeTeachers"
                stateAvg={stateAverages?.activeTeachers}
              />
              <MetricRow
                label="Participation"
                data={comparisonData}
                metric="participationRate"
                stateAvg={stateAverages?.participationRate}
                format="percent"
                highlightBest
              />
              <tr className="separator" />
              <MetricRow
                label="Submissions"
                data={comparisonData}
                metric="submissions"
                stateAvg={stateAverages?.submissions}
              />
              <MetricRow
                label="Verified"
                data={comparisonData}
                metric="verified"
                stateAvg={stateAverages?.verified}
              />
              <MetricRow
                label="Ver. Rate"
                data={comparisonData}
                metric="verificationRate"
                stateAvg={stateAverages?.verificationRate}
                format="percent"
                highlightBest
              />
              <tr className="separator" />
              <MetricRow
                label="Captured"
                data={comparisonData}
                metric="captured"
                stateAvg={stateAverages?.captured}
              />
              <MetricRow
                label="Capture Rate"
                data={comparisonData}
                metric="captureRate"
                stateAvg={stateAverages?.captureRate}
                format="percent"
              />
              <tr className="separator" />
              <MetricRow
                label="Fraud Cases"
                data={comparisonData}
                metric="fraudCases"
                stateAvg={stateAverages?.fraudCases}
              />
              <MetricRow
                label="Fraud Rate"
                data={comparisonData}
                metric="fraudRate"
                stateAvg={stateAverages?.fraudRate}
                format="percent"
                highlightBest
                lowerIsBetter
              />
              <tr className="separator" />
              <MetricRow
                label="Total Payout"
                data={comparisonData}
                metric="totalPayout"
                stateAvg={stateAverages?.totalPayout}
                format="currency"
              />
              <MetricRow
                label="Avg/Teacher"
                data={comparisonData}
                metric="avgPayoutPerTeacher"
                stateAvg={stateAverages?.avgPayoutPerTeacher}
                format="currency"
              />
            </tbody>
          </table>
          <div className="table-legend">
            <span className="legend-item">â¬† Best performer</span>
            <span className="legend-item">â¬‡ Lowest</span>
            <span className="legend-item">âš  Outlier (&gt;1.5Ã— std dev)</span>
          </div>
        </div>
      )}

      {/* Trend Comparison */}
      {trendChartData && (
        <div className="trend-comparison-section">
          <h2>Trend Comparison (Last 6 Months)</h2>
          <Line
            data={trendChartData}
            options={{
              responsive: true,
              plugins: {
                legend: { position: 'bottom' }
              },
              scales: {
                y: {
                  beginAtZero: true,
                  title: { display: true, text: 'Participation Rate (%)' }
                }
              }
            }}
          />
        </div>
      )}

      {/* State Rankings */}
      <div className="rankings-section">
        <div className="rankings-header">
          <h2>State Rankings (All 38 Districts)</h2>
          <select
            value={rankingMetric}
            onChange={(e) => setRankingMetric(e.target.value)}
          >
            {Object.entries(DistrictComparisonService.COMPARISON_METRICS).map(([key, value]) => (
              <option key={key} value={value}>{getMetricLabel(value)}</option>
            ))}
          </select>
        </div>
        <div className="rankings-table-container">
          <table className="rankings-table">
            <thead>
              <tr>
                <th>Rank</th>
                <th>District</th>
                <th>Part. Rate</th>
                <th>Ver. Rate</th>
                <th>Fraud</th>
                <th>Trend</th>
              </tr>
            </thead>
            <tbody>
              {rankings.slice(0, 5).map((district, index) => (
                <tr key={district.id} className="top-performer">
                  <td>{index + 1}.</td>
                  <td>{district.name}</td>
                  <td>{district.participationRate}%</td>
                  <td>{district.verificationRate}%</td>
                  <td>{district.fraudRate}%</td>
                  <td className={district.trend >= 0 ? 'positive' : 'negative'}>
                    {district.trend >= 0 ? 'â†‘' : 'â†“'}{Math.abs(district.trend)}%
                  </td>
                </tr>
              ))}
              <tr className="ellipsis">
                <td colSpan="6">...</td>
              </tr>
              {rankings.slice(-4).map((district, index) => (
                <tr key={district.id} className="low-performer">
                  <td>{rankings.length - 3 + index}.</td>
                  <td>{district.name}</td>
                  <td>{district.participationRate}%</td>
                  <td>{district.verificationRate}%</td>
                  <td>{district.fraudRate}%</td>
                  <td className={district.trend >= 0 ? 'positive' : 'negative'}>
                    {district.trend >= 0 ? 'â†‘' : 'â†“'}{Math.abs(district.trend)}%
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
        <button className="view-full-btn">View Full Rankings</button>
      </div>

      {/* Actions */}
      <div className="comparison-actions">
        <button className="btn-primary" onClick={exportComparison}>
          Export Comparison
        </button>
        <button className="btn-secondary" onClick={saveAsTemplate}>
          Save as Template
        </button>
        <button className="btn-secondary" onClick={shareReport}>
          Share Report
        </button>
      </div>
    </div>
  );

  function exportComparison() {
    // Export logic
  }

  function saveAsTemplate() {
    localStorage.setItem('comparisonTemplate', JSON.stringify(selectedDistricts));
  }

  function shareReport() {
    // Share logic
  }
}

function MetricRow({ label, data, metric, stateAvg, format, highlightBest, lowerIsBetter }) {
  const values = data.map(d => d[metric]);
  const best = lowerIsBetter ? Math.min(...values) : Math.max(...values);
  const worst = lowerIsBetter ? Math.max(...values) : Math.min(...values);

  const formatValue = (value) => {
    if (format === 'percent') return `${value}%`;
    if (format === 'currency') return `â‚¹${(value / 100000).toFixed(2)}L`;
    return value.toLocaleString();
  };

  return (
    <tr>
      <td className="metric-label">{label}</td>
      {data.map(d => {
        const isBest = d[metric] === best;
        const isWorst = d[metric] === worst;
        const isOutlier = d.isOutlier && d.outlierMetric === metric;

        return (
          <td key={d.id} className={`metric-value ${isBest ? 'best' : ''} ${isWorst ? 'worst' : ''}`}>
            {formatValue(d[metric])}
            {isBest && ' â¬†'}
            {isWorst && ' â¬‡'}
            {isOutlier && ' âš '}
          </td>
        );
      })}
      <td className="state-avg">{formatValue(stateAvg)}</td>
    </tr>
  );
}

function getMetricLabel(metric) {
  const labels = {
    participationRate: 'Participation Rate',
    verificationRate: 'Verification Rate',
    captureRate: 'Capture Rate',
    fraudRate: 'Fraud Rate',
    totalPayout: 'Total Payout',
    avgPayoutPerTeacher: 'Avg Payout/Teacher',
    submissions: 'Submissions'
  };
  return labels[metric] || metric;
}

function getDistrictColor(index) {
  const colors = ['#2196f3', '#4caf50', '#ff9800', '#9c27b0', '#f44336'];
  return colors[index % colors.length];
}

function getLastMonthStart() {
  const date = new Date();
  date.setDate(date.getDate() - 30);
  return date;
}

export default DistrictComparison;
```

## Dependencies

- **All District APIs**: Metrics from all districts
- **egov-user**: Teacher data
- **Chart.js**: Visualization

## Related Stories

- [SA-01](./SA-01.md) - Statewide Metrics
- [DA-03](../district-admin/DA-03.md) - Teacher Participation
- [SA-04](./SA-04.md) - Fraud Analytics

## Notes

- Up to 5 districts can be compared simultaneously
- State averages provide baseline for comparison
- Outlier detection highlights districts requiring attention
- Rankings auto-update as new data comes in
- Comparison templates can be saved for quick access
